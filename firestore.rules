rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    match /users/{userId} {
      // Users can read their own profile, update their displayName, etc.
      // Creation is handled by the backend function/provider upon first sign-in.
      allow read, update, create: if request.auth != null && request.auth.uid == userId;

      // Transactions
      match /transactions/{transactionId} {
        // Users can read and write (create, update, delete) their own transactions.
        allow read, write: if request.auth != null && request.auth.uid == userId;
      }

      // Categories
      match /categories/{categoryId} {
        // Users can read and write their own categories.
        allow read, write: if request.auth != null && request.auth.uid == userId;
      }

      // Bank Accounts
      match /bankAccounts/{bankAccountId} {
        // Users can read and write their own bank accounts.
        allow read, write: if request.auth != null && request.auth.uid == userId;
      }

      // Credit Cards
      match /creditCards/{creditCardId} {
        // Users can read and write their own credit cards.
        allow read, write: if request.auth != null && request.auth.uid == userId;
      }

      // Savings Rules
      match /savingsRules/{savingsRuleId} {
        // Users can read and write their own savings rules.
        allow read, write: if request.auth != null && request.auth.uid == userId;
      }
    }
  }
}
